/**
 * @preserve
 * Flair.js Fabric
 * Foundation for True Object Oriented JavaScript Apps
 * 
 * Assembly: flair.client
 *     File: ./flair.client.js
 *  Version: 0.59.31
 *  Mon, 09 Sep 2019 23:49:55 GMT
 * 
 * (c) 2017-2019 Vikas Burman
 * MIT
 */
!function(t,e){"use strict";"function"==typeof!0&&(!0).amd?(!0)(()=>e):"object"==typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),module.exports=exports=e):t["flair.client"]=e}(this,async function(t,e){"use strict";const{Class:i,Struct:s,Enum:a,Interface:n,Mixin:r,Aspects:o,AppDomain:l,$$:h,attr:c,bring:u,Container:p,include:d,Port:m,on:f,post:y,telemetry:w,Reflector:b,Serializer:v,Tasks:g,as:$,is:V,isDefined:x,isComplies:T,isDerivedFrom:C,isAbstract:S,isSealed:I,isStatic:O,isSingleton:E,isDeprecated:P,isImplements:L,isInstanceOf:A,isMixed:W,getAssembly:N,getAttr:R,getContext:j,getResource:D,getRoute:M,getType:H,ns:B,getTypeOf:k,getTypeName:U,typeOf:F,dispose:z,using:_,Args:J,Exception:q,noop:G,nip:Y,nim:K,nie:Q,event:X}=t,{TaskInfo:Z}=t.Tasks,{env:tt}=t.options,{guid:et,stuff:it,replaceAll:st,splitAndTrim:at,findIndexByProp:nt,findItemByProp:rt,which:ot,isArrowFunc:lt,isASyncFunc:ht,sieve:ct,deepMerge:ut,getLoadedScript:pt,b64EncodeUnicode:dt,b64DecodeUnicode:mt,lens:ft,globalSetting:yt}=t.utils,{$$static:wt,$$abstract:bt,$$virtual:vt,$$override:gt,$$sealed:$t,$$private:Vt,$$privateSet:xt,$$protected:Tt,$$protectedSet:Ct,$$readonly:St,$$async:It,$$overload:Ot,$$enumerate:Et,$$dispose:Pt,$$post:Lt,$$on:At,$$timer:Wt,$$type:Nt,$$args:Rt,$$inject:jt,$$resource:Dt,$$asset:Mt,$$singleton:Ht,$$serialize:Bt,$$deprecate:kt,$$session:Ut,$$state:Ft,$$conditional:zt,$$noserialize:_t,$$ns:Jt}=h,qt=tt.isServer||tt.isWorker?null:(!0).document,Gt=l.context.current().name,Yt=e,Kt=Yt.substr(0,Yt.lastIndexOf("/")+1);l.loadPathOf("flair.client",Kt);let Qt=JSON.parse('{"view":{"mainEl":"main","viewEl":"view","transition":"","handler":"flair.ui.vue.VueView","layout":{"client":"","server":"","static":""},"routes":{"home":"","notfound":""}},"i18n":{"lang":{"default":"en","locales":[{"code":"en","name":"English","native":"English"}]}},"routing":{"mounts":{"main":"/"},"all":{"before":{"settings":[{"name":"hashbang","value":false},{"name":"sensitive","value":false}],"interceptors":[]},"after":{"settings":[],"interceptors":[]}}}}'),Xt=t.Port("settingsReader");if("function"==typeof Xt){let t=Xt("flair.client");t&&(Qt=ut([Qt,t],!1))}Qt=Object.freeze(Qt);let Zt=JSON.parse("{}");return Zt=Object.freeze(Zt),l.context.current().currentAssemblyBeingLoaded("./flair.client{.min}.js"),await(async()=>{const{ViewComponent:t}=await B("flair.ui");h("ns","flair.ui"),r("ViewComponentMembers",function(){let e={},i=et(),s=m("clientFile"),a="";h("protected"),this.name="",h("readonly"),this.id="",h("readonly"),this.inViewName="",h("protected"),this.host=null,h("protected"),this.html=null,h("protected"),this.style=null,h("protected"),this.data=null,h("protected"),this.baseName="",h("protected"),this.basePath="",h("protected"),this.localePath="",h("protected"),this.components={},h("protected"),this.i18n=null,h("private"),this.init=(async(t,e)=>{if(a=t||"",this.inViewName=a,this.id=i,await this.beforeInit(e),this.name=this.name||e.getName(!0),!this.baseName){let t=e.getName(),i=t.substr(t.lastIndexOf(".")+1);this.baseName=i}this.basePath||(this.basePath=e.getAssembly().assetsPath()),this.localePath||(this.localePath=e.getAssembly().localesPath()),await this.afterInit(e),this.initContent(),await this.assembleView()}),h("private"),this.initContent=(async()=>{const t=async()=>{"boolean"==typeof this.style&&!0===this.style?this.style=ot(`./${this.baseName}/index{.min}.css`,!0):this.style=this.getResIfDefined(this.style),"boolean"==typeof this.html&&!0===this.html?this.html=ot(`./${this.baseName}/index{.min}.html`,!0):this.html=this.getResIfDefined(this.html),"boolean"==typeof this.data&&!0===this.data?this.data=ot(`./${this.baseName}/index{.min}.json`,!0):this.data=this.getResIfDefined(this.data)},e=async()=>{if("string"==typeof this.html&&this.html.endsWith(".html")){this.html=this.html.replace("./",this.basePath),this.html=await s(this.html);let t=this.extractContent(this.html);t.data&&(this.data=t.data),t.style&&(this.style=t.style),this.html=t.html||""}this.html=`<div id="${i}">${this.html}</div>`},n=async()=>{if("string"==typeof this.style&&this.style.endsWith(".css")&&(this.style=this.style.replace("./",this.basePath),this.style=await s(this.style)),this.style){let t=`${a}_${i}`,e=st(this.style,"#SCOPE_ID",`#${t}`);this.addStyle(e,t)}},r=async()=>{"string"==typeof this.data&&(this.data.endsWith(".json")?(this.data=this.data.replace("./",this.basePath),this.data=await s(this.data)):this.data=JSON.parse(this.data))},o=async()=>{if(this.i18n){let t="";if("string"==typeof this.i18n){let t=this.i18n.split(",");this.i18n={};for(let e of t)this.i18n[e.trim()]=!1}let e=this.localePath+this.locale()+"/";for(let i in this.i18n)this.i18n.hasOwnProperty(i)&&(t=(t=this.i18n[i]||`./${i}.json`).replace("./",e),this.i18n[i]=await s(t))}};await t(),await e(),await n(),await r(),await o()}),h("private"),this.load=(async(t,e)=>{await this.beforeLoad(t,e),await this.onLoad(t,e),await this.afterLoad(t,e)}),h("protected"),h("virtual"),this.onLoad=(async(e,i)=>{i.innerHTML=this.html;let s=this.getComponents(i),n=null,r=null,o=null;for(let l of s)this.components[l.name]||(n=i.getElementById(l.id))&&(r=$(await d(l.type),t))&&(o=new r)&&(this.components[l.name]=o.view(a,e,n,l.params));this.html=i.innerHTML}),h("protected"),this.getComponents=(t=>{let e=[];if(t){let i;e=this.extractComponents(t).components}else{let t;e=this.extractContent(this.html).elements.components}return e}),h("private"),this.addStyle=((t,e)=>{if(t){let s=(!0).document.createElement("style");s.id=e||`${a}_${i}`,s.type="text/css",s.appendChild((!0).document.createTextNode(t)),(!0).document.head.appendChild(s)}}),h("private"),this.getResIfDefined=(t=>{if("string"==typeof t&&t.startsWith("res:")){let e=t.substr(4),i=l.context.current().getResource(e)||null;return i?i.data:t}return t}),h("private"),this.extractContent=(t=>{let e=null,i={html:null,style:null,data:null,elements:{components:[],view:null},updatedHtml:()=>e.body.innerHTML},s=new(!0).DOMParser,a=(e=s.parseFromString(t,"text/html")).getElementsByTagName("script");if(a)for(let t of a)t.parentNode.remove(t);let n=e.getElementsByTagName("style");if(n&&n.length>0){i.style=n[0].innerHTML;for(let t of n)t.parentNode.remove(t)}let r=e.getElementsByTagName("data");if(r&&r.length>0){i.data=r[0].innerHTML;for(let t of r)t.parentNode.remove(t)}return i.elements=this.extractComponents(e.body),i.html=e.body.innerHTML,i}),h("private"),this.extractComponents=(t=>{let e={components:[],view:null},i=t.getElementsByTagName("comp");if(i){let t="",s=Qt.view.viewEl||"view";for(let a of i)if(""!==(t=a.getAttribute("type")))if(t===s)e.view||(e.view=a);else{let t=a.getAttribute("id"),i=a.getAttribute("type")||"",s=a.getAttribute("params")||"",n=a.getAttribute("name");t||(t=et(),a.setAttribute("id",t)),n||(n=st(i,".","_"),a.setAttribute("name",n)),e.components.push({id:t,name:n,type:i,params:s})}}return e}),h("protected"),this.locale=(t=>l.host().locale(t,!0)),h("protected"),this.version=(t=>l.host().version(t,!0)),h("protected"),this.path=((t,e)=>l.host().pathToUrl(t,e)),h("protected"),this.route=((t,e)=>l.host().routeToUrl(t,e)),h("protected"),this.i18nValue=(t=>{let e=t||"",i=tt.isDebug?":":"";if(t&&t.startsWith("@")){let s=(t=t.substr(1)).split("|");t=s[0].trim(),e=s[1].trim()||"",this.i18n&&(e=ft(this.i18n,t)||i+e+i)}return e||"(i18n: 404)"}),h("protected"),this.cancelLoadData=(async()=>{let t=null;for(let i in e)if(e.hasOwnProperty(i))try{(t=e[i])&&t.abort()}catch(t){}e={}}),h("protected"),this.abortHandle=(t=>{t=t||et();let i=new AbortController;return e[t]=i,i}),h("protected"),this.abort=(t=>{try{let i;e[t].abort()}catch(t){}}),h("protected"),h("virtual"),h("async"),this.beforeLoad=G,h("protected"),h("virtual"),h("async"),this.afterLoad=G,h("protected"),h("virtual"),h("async"),this.loadData=G})})(),await(async()=>{h("ns","flair.ui"),i("ViewTransition",function(){h("virtual"),h("async"),this.enter=G,h("virtual"),h("async"),this.leave=G})})(),await(async()=>{h("ns","flair.ui"),a("ViewTypes",function(){this.Client=0,this.Server=1,this.Static=2})})(),await(async()=>{const{Handler:t,ViewTypes:e}=await B("flair.app");h("ns","flair.ui"),i("ViewHandler",t,function(){h("override"),this.construct=((t,i)=>{t(i),this.type=i.type||e.Client,!this.type===e.Client&&(this.path=i.handler,this.connection=i.connection||"")}),h("readonly"),this.type=-1,h("protected"),this.path="",h("protected"),this.connection="",h("protected"),h("virtual"),h("async"),this.loadView=G,this.view=(async t=>{await this.loadView(t)})})})(),await(async()=>{const{ViewTypes:t,ViewHandler:e,ViewTransition:s,ViewComponentMembers:a}=await B("flair.ui");h("ns","flair.ui"),i("View",e,[a],function(){let e="",i="";h("override"),this.construct=((t,s)=>{t(s),this.host=this,e=Qt.view.mainEl||"main",i=Qt.view.viewEl||"view",this.viewTransition=Qt.view.transition||""}),h("privateSet"),this.viewTransition="",h("protected"),this.layout="",h("protectedSet"),this.title="",h("protectedSet"),this.meta=null,h("protected"),h("override"),h("sealed"),this.loadView=(async(t,i)=>{this.$static.outView=this.$static.currentView,this.$static.inView=this,t(i),await this.init(this.$static.inView.name,this.$Type);let s=null,a=qt.getElementById(e);if(this.$static.outView&&this.$static.outView.name===this.$static.inView.name?s=qt.getElementById(this.name):((s=qt.createElement("div")).id=this.name,s.setAttribute("hidden",""),a.appendChild(s)),await this.load(i,s),await this.swap(),this.loadData(i),this.$static.outView&&this.$static.outView.name!==this.$static.inView.name){let t=document.head.getElementsByTagName("style");if(t&&t.length>0){let e="";for(let i of t)(e=i.getAttribute("id")||"").startsWith(this.$static.outView.name)&&i.parentNode.remove(i)}}this.$static.outView=null,this.$static.inView=null}),h("protected"),this.assembleView=(async()=>{let e=m("clientFile");const s=async()=>{if("boolean"==typeof this.layout&&!0===this.layout)switch(this.type){case t.Client:Qt.view.layout.client;break;case t.Server:Qt.view.layout.server;break;case t.Static:Qt.view.layout.static;break}"string"==typeof this.layout&&(this.layout.startsWith("res:")?this.layout=this.getResIfDefined(this.layout):this.layout.endsWith(".html")&&(this.layout=this.layout.replace("./",this.basePath),this.layout=await e(this.layout))),this.layout||(this.layout=`<div type="${i}"></div>`)},a=async()=>{let t=this.extractContent(this.layout);if(t.style){let e=`${this.$static.inView.name}_${this.id}_LAYOUT`,i=st(t.style,"#SCOPE_ID",`#${e}`);this.addStyle(i,e)}t.html&&(t.elements.view&&(t.elements.view.innerHTML=this.html),this.html=t.updatedHtml())};await s(),await a()}),h("private"),this.swap=(async()=>{let t=qt.getElementById(this.name);if(this.$static.outView){let i=qt.getElementById(this.$static.outView.name);if(this.$static.outView.name!==this.$static.inView.name){if(this.$static.outView.meta)for(let t of this.$static.outView.meta)qt.head.removeChild(qt.querySelector('meta[name="'+t+'"]'));this.viewTransition?(await this.viewTransition.leave(i,t),await this.viewTransition.enter(t,i)):(i&&(i.hidden=!0),t.hidden=!1);let s=qt.getElementById(e);i&&s.removeChild(i)}}if(!this.$static.outView||this.$static.outView.name!==this.$static.inView.name){if(this.meta)for(let t of this.meta){var i=document.createElement("meta");for(let e in t)i[e]=t[e];qt.head.appendChild(i)}!this.$static.outView&&t&&(t.hidden=!1)}this.title=this.i18nValue(this.title),qt.title=this.title,this.$static.currentView=this}),h("protected"),h("virtual"),this.beforeInit=(async e=>{if(this.viewTransition){let t=$(await d(this.viewTransition),s);this.viewTransition=t?new t:""}if(this.type===t.Static&&-1!==this.path.indexOf("{.en}")&&(this.path=this.path.replace("{.en}","."+this.locale())),this.type===t.Static||this.type===t.Server){if(!this.baseName){let t=this.route.name,e=t.substr(t.lastIndexOf(".")+1);this.baseName=e}this.basePath||(this.basePath=this.route.getAssembly().assetsPath()),this.localePath||(this.localePath=this.route.getAssembly().localesPath())}}),h("protected"),h("virtual"),this.afterInit=(async e=>{const i=async()=>{let t=m("clientFile"),e="";try{e=await t(this.path)}catch(t){e=t.toString()}return e},s=async()=>{let t="";try{}catch(e){t=e.toString()}return t};let a="";this.type===t.Static?a=await i():this.type===t.Server&&(a=await s());let n=this.extractContent(a);n.style&&(this.style=n.style),n.data&&(this.data=n.data),n.html&&(this.html=n.html)}),h("static"),this.currentView=null,h("static"),this.inView=null,h("static"),this.outView=null})})(),await(async()=>{const{ViewComponentMembers:t}=await B("flair.ui");h("ns","flair.ui"),i("ViewComponent",[t],function(){let t="";this.view=(async(e,i,s,a)=>(t=e||"","string"==typeof a?(a=a.trim()).startsWith("[")&&this.params.endsWith("]")||a.startsWith("{")&&this.params.endsWith("}")?this.params=JSON.params(a):this.params=a.split(","):"object"==typeof a&&(this.params=a),await this.loadView(i,s),this.viewComponentObject||this)),h("protected"),this.params=null,h("protected"),this.viewComponentObject=null,h("protected"),this.loadView=(async(e,i)=>{await this.init(t,this.$Type),await this.load(e,i),this.loadData(e)}),h("protected"),h("virtual"),h("async"),this.assembleView=G,h("protected"),h("virtual"),h("async"),this.beforeInit=G,h("protected"),h("virtual"),h("async"),this.afterInit=G})})(),await(async()=>{h("sealed"),h("ns","flair.ui"),i("Page",function(){let t=[],e;this.construct=((t,e)=>{this.params=e||"",this.hasbang=t.hasbang||!1,this.base=t.base||"",this.sensitive=t.sensitive||!1,this.base.endsWith("/")&&(this.base=this.base.substr(0,this.base.length-1)),this.base.startsWith("/")||(this.base="/"+this.base)}),h("readonly"),this.hasbang=!1,h("readonly"),this.params="",h("readonly"),this.base="",h("readonly"),this.sensitive=!1,h("private"),this.pathToRegExp=((t,e)=>{t.startsWith("/")&&(t=t.substr(1)),t.endsWith("/")&&(t=t.substr(0,t.length-1));let i=t?t.split("/"):[],s="",a=0;for(let t of i)(t=t.trim()).startsWith(":")?(e.push({name:t.substr(1),index:a}),s+="/.[^/]*"):s+="/"+t,a++;s+="/";let n=null;return n=this.sensitive?new RegExp(s):new RegExp(s,"i")}),this.breakUrl=(e=>{let i={url:e,path:"",locale:"",version:"",params:{},handler:null,route:null},s=e;"/"===s.substr(0,1)&&(s=s.substr(1)),"#!/"===s.substr(0,3)&&(s=s.substr(3)),"#!"===s.substr(0,2)&&(s=s.substr(2)),"#/"===s.substr(0,2)&&(s=s.substr(2)),"#"===s.substr(0,1)&&(s=s.substr(1)),"/"===s.substr(0,1)&&(s=s.substr(1)),(s="/"+s).startsWith(this.base)&&(s=s.substr(this.base.length)),s.startsWith("/")||(s="/"+s);let a=s.indexOf("?"),n="",r=null;if(-1!==a){n=s.substr(a+1),s=s.substr(0,a);let t=n.split("&"),e=null;for(let i of t)e=i.split("="),(r=r||{})[e[0].trim()]=decodeURIComponent(e[1].trim())}s.endsWith("/")||(s+="/"),i.path=s;for(let e of t){let t=e.regex.exec(decodeURIComponent(s));if(t&&t.input===t[0]){s.startsWith("/")&&(s=s.substr(1)),s.endsWith("/")&&(s=s.substr(0,s.length-1));let t=s?s.split("/"):[];for(let s of e.keys)i.params[s.name]=t[s.index];if(i.handler=e.handler,i.route=e.route,this.params){let t="";t=":version",-1!==this.params.indexOf(t)&&i.params["version"]&&(i.version=i.params["version"]),t=":locale",-1!==this.params.indexOf(t)&&i.params["locale"]&&(i.locale=i.params["locale"])}break}}return r&&(i.params=Object.assign(i.params,r)),i}),this.buildUrl=((t,e)=>{let i=this.base;if(i.endsWith("/")||(i+="/"),this.params){let t=this.params;t.startsWith("/")&&(t=t.substr(1)),i+=t,e=e||{};let s="";s=":version",-1!==t.indexOf(s)&&(e["version"]=l.host().version()),s=":locale",-1!==t.indexOf(s)&&(e["locale"]=l.host().locale())}if(t.startsWith("/")&&(t=t.substr(1)),(i+=t).startsWith("/")||(i="/"+i),(i=this.hasbang?"#!"+i:"#"+i).endsWith("/")||(i+="/"),e){let t=-1,s="?",a=null;for(let n in e)e.hasOwnProperty(n)&&(t=i.indexOf(`:${n}`),a=encodeURIComponent(e[n].toString()),-1!==t?i=st(i,`:${n}`,a):s+=`${n}=${a}`);"?"!==s&&(i+=s)}return i}),this.add=((e,i)=>{let s=e.path;if(this.params){let t=this.params;t.startsWith("/")||(t="/"+t),t.endsWith("/")||(t+="/"),s=(t+=s).replace("//","/")}let a=[];t.push({route:e,path:s,keys:a,regex:this.pathToRegExp(s,a),handler:i})}),this.add404=(t=>{e=t}),this.run=(async t=>{let i={$url:t,$page:"",$route:"",$handler:"",$mount:"",$locale:"",$version:"",$path:"",$stop:!1,$redirect:{route:"",params:{}}},s=this.breakUrl(t),a=s.params;i.$locale=s.locale,i.$version=s.version,s.route?(i.$route=s.route.name,i.$handler=s.route.handler,i.$mount=s.route.mount,i.$path=s.route.path):i.$path=s.path,a&&(i=Object.assign(i,a));try{if(s.handler){if(s.locale&&l.host().locale(s.locale),s.version&&l.host().version(s.version),await s.handler(i),i.$redirect.route){let t=i.$redirect,e=i.$params;setTimeout(()=>{l.host().redirect(t,e)},0)}}else await e(i)}catch(t){l.host().raiseError(t)}})})})(),await(async()=>{const{Bootware:t}=await B("flair.app"),{ViewTypes:e,ViewHandler:s,ViewInterceptor:a}=await B("flair.ui");h("sealed"),h("ns","flair.boot"),i("ClientRouter",t,function(){let t=null;h("override"),this.construct=(t=>{t("Client Router",!0)}),h("override"),this.boot=(async(i,n)=>{i(),t||(t=l.context.current().allRoutes(!0)).sort((t,e)=>t.index<e.index?-1:t.index>e.index?1:0);const r=async t=>{let e=this.getMountSpecificSettings("interceptors",Qt.routing,n.name);for(let i of e){let e=$(await d(i),a);if(!e)throw q.InvalidDefinition(`Invalid interceptor type. (${i})`);if(await(new e).run(t),t.$stop)break}},o=async(t,i,a)=>{t.type&&t.type!==e.Client&&(i=Qt.view.handler||"");let n=$(await d(i),s);if(!n)throw q.InvalidDefinition(`Invalid route handler. (${i})`);{let e=new n(t);await e.view(a)}},h=t=>"string"==typeof t.handler?t.handler:t.handler[l.app().getRoutingContext(t.name)]||"**undefined**",c=t=>async e=>{if(await r(e),!e.$stop){let i=h(t);await o(t,i,e)}},u=(t,e)=>{t.add(e,c(e))};let p=n.app;for(let e of t)("string"==typeof e.mount&&e.mount===n.name||-1!==e.mount.indexOf(n.name))&&e.name!==Qt.view.routes.notfound&&u(p,e);p.add404(async t=>{let e=Qt.view.routes.notfound;if(e&&(e=l.context.current().getRoute(e)),!e)return alert(`404: ${t.$url} not found.`),void setTimeout(()=>{(!0).history.back()},0);await o(e.handler,t)})})})})(),await(async()=>{const{Host:t}=await B("flair.app"),{ViewHandler:e,Page:s}=await B("flair.ui");h("sealed"),h("ns","flair.app"),i("ClientHost",t,function(){let t={},i=null;h("override"),this.construct=(t=>{t("Client"),this.currentLocale=this.defaultLocale}),this.app={get:()=>this.mounts["main"].app,set:G},this.mounts={get:()=>t,set:G},h("state"),h("private"),this.currentLocale="",this.defaultLocale={get:()=>Qt.i18n.lang.default,set:G},this.supportedLocales={get:()=>Qt.i18n.lang.locales.slice(),set:G},this.locale=((t,e)=>{if(t&&this.currentLocale!==t&&-1!==nt(this.supportedLocales,"code",t)){let i=this.currentLocale;if(this.currentLocale=t,tt.props("api","locale".newLocale),e){let e=(!0).location.hash.replace(i,t);this.go(e)}}return this.currentLocale}),h("state"),h("private"),this.currentVersion="",this.version=((t,e)=>{if(t&&this.currentVersion!==t){let i=this.currentVersion;if(this.currentVersion=t,tt.props("api","version".newVersion),e){let e=(!0).location.hash.replace(i,t);this.go(e)}}return this.currentVersion}),this.routeToUrl=((t,e)=>{if(!t)return null;let i=l.context.current().getRoute(t),s;return i?this.mounts[i.mount].app.buildUrl(i.path,e):st(t,".","_")}),this.pathToUrl=((t,e)=>{let i;return this.urlToApp(t).buildUrl(t,e)}),h("private"),this.urlToApp=(t=>{"#!/"===t.substr(0,3)&&(t=t.substr(3)),"#!"===t.substr(0,2)&&(t=t.substr(2)),t.startsWith("/")||(t="/"+t);let e=null;for(let i in this.mounts)this.mounts.hasOwnProperty(i)&&t.startsWith(i.base)&&i.base.length>e.base.length&&(e=i);return e?e.app:this.app}),this.view={get:()=>e.currentView,set:G},this.redirect=(async(t,e,i)=>{await this.navigate(t,e,!0),i&&await this.refresh()}),this.navigate=(async(t,e,i)=>{e=e||{};let s=this.routeToUrl(t,e);s?await this.go(s,i):this.raiseError(q.NotFound(t,this.navigate))}),this.go=(async(t,e)=>{e?"#/"!==t&&history.replaceState(null,null,(!0).document.location.pathname+t):("#"===t.substr(0,1)&&(t=t.substr(1)),window.location.hash=t)}),this.refresh=(async()=>{setTimeout(()=>{i()},0)}),h("override"),this.boot=(async e=>{e();let i={},a=null,n="";const r=t=>{let e=this.getMountSpecificSettings("settings",Qt.routing,t,"name");if(e&&e.length>0)for(let t of e)i[t.name]=t.value;return i.base=Qt.routing.mounts[t],i};i=r("main");let o=(Qt.routing["main"]?Qt.routing["main"]["params"]:"")||"",l=new s(i,o);for(let e of Object.keys(Qt.routing.mounts))"main"===e?(a=l,n=o):(i=r(e),n=(Qt.routing[e]?Qt.routing[e]["params"]:"")||"",a=new s(i,n)),t[e]=Object.freeze({name:e,root:a.base,params:n,app:a});t=Object.freeze(t)}),h("override"),this.start=(async t=>{t(),i=(async()=>{let t=this.urlToApp((!0).location.hash);await t.run((!0).location.hash)})}),h("override"),this.ready=(async t=>{t(),(!0).addEventListener("hashchange",i),(!0).location.hash?await i():Qt.view.routes.home?await this.redirect(Qt.view.routes.home,{},!0):console.log(`No home route is configured.`),console.log(`${l.app().info.name}, v${l.app().info.version}`)}),h("override"),this.stop=(async t=>{t(),(!0).removeEventListener("hashchange",i)}),h("override"),this.dispose=(e=>{e(),t=null})})})(),await(async()=>{h("ns","flair.ui"),i("ViewInterceptor",function(){h("virtual"),h("async"),this.run=G})})(),await(async()=>{h("singleton"),h("ns","flair.ui"),i("ViewState",function(){h("state"),h("private"),this.store={},this.get=((t,e)=>(t=t||"",e=e||"",this.store[t+"/"+e]||null)),this.set=((t,e,i)=>{t=t||"",e=e||"","boolean"==typeof i||i?this.store[t+"/"+e]=i:delete this.store[t+"/"+e]}),this.clear=(()=>{this.store=null})})})(),l.context.current().currentAssemblyBeingLoaded(),l.registerAdo('{"name":"flair.client","file":"./flair.client{.min}.js","package":"flairjs-fabric","desc":"Foundation for True Object Oriented JavaScript Apps","title":"Flair.js Fabric","version":"0.59.31","lupdate":"Mon, 09 Sep 2019 23:49:55 GMT","builder":{"name":"flairBuild","version":"1","format":"fasm","formatVersion":"1","contains":["init","func","type","vars","reso","asst","rout","sreg"]},"copyright":"(c) 2017-2019 Vikas Burman","license":"MIT","types":["flair.ui.ViewComponentMembers","flair.ui.ViewTransition","flair.ui.ViewTypes","flair.ui.ViewHandler","flair.ui.View","flair.ui.ViewComponent","flair.ui.Page","flair.boot.ClientRouter","flair.app.ClientHost","flair.ui.ViewInterceptor","flair.ui.ViewState"],"resources":[],"assets":[],"routes":[]}'),"function"==typeof onLoadComplete&&onLoadComplete(),Object.freeze({name:"flair.client",settings:Qt,config:Zt})});
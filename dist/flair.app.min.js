/**
 * @preserve
 * Flair.js Fabric
 * Foundation for True Object Oriented JavaScript Apps
 * 
 * Assembly: flair.app
 *     File: ./flair.app.js
 *  Version: 0.55.24
 *  Fri, 09 Aug 2019 19:18:02 GMT
 * 
 * (c) 2017-2019 Vikas Burman
 * MIT
 */
!function(e,t){"use strict";"function"==typeof!0&&(!0).amd?(!0)(()=>t):"object"==typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),module.exports=exports=t):e["flair.app"]=t}(this,async function(e,t){"use strict";const{Class:a,Struct:i,Enum:r,Interface:s,Mixin:o,Aspects:n,AppDomain:c,$$:l,attr:p,bring:f,Container:d,include:u,Port:h,on:y,post:w,telemetry:$,Reflector:m,Serializer:v,Tasks:b,as:g,is:S,isDefined:A,isComplies:k,isDerivedFrom:C,isAbstract:E,isSealed:O,isStatic:x,isSingleton:B,isDeprecated:I,isImplements:j,isInstanceOf:M,isMixed:D,getAssembly:H,getAttr:T,getContext:W,getResource:F,getRoute:P,getType:z,ns:R,getTypeOf:L,getTypeName:N,typeOf:V,dispose:J,using:_,Args:U,Exception:G,noop:q,nip:K,nim:Q,nie:X,event:Y}=e,{TaskInfo:Z}=e.Tasks,{env:ee}=e.options,{guid:te,forEachAsync:ae,stuff:ie,replaceAll:re,splitAndTrim:se,findIndexByProp:oe,findItemByProp:ne,which:ce,isArrowFunc:le,isASyncFunc:pe,sieve:fe,deepMerge:de,getLoadedScript:ue,b64EncodeUnicode:he,b64DecodeUnicode:ye,lens:we,globalSetting:$e}=e.utils,{$$static:me,$$abstract:ve,$$virtual:be,$$override:ge,$$sealed:Se,$$private:Ae,$$privateSet:ke,$$protected:Ce,$$protectedSet:Ee,$$readonly:Oe,$$async:xe,$$overload:Be,$$enumerate:Ie,$$dispose:je,$$post:Me,$$on:De,$$timer:He,$$type:Te,$$args:We,$$inject:Fe,$$resource:Pe,$$asset:ze,$$singleton:Re,$$serialize:Le,$$deprecate:Ne,$$session:Ve,$$state:Je,$$conditional:_e,$$noserialize:Ue,$$ns:Ge}=l,qe=ee.isServer||ee.isWorker?null:(!0).document,Ke=c.context.current().name,Qe=t,Xe=Qe.substr(0,Qe.lastIndexOf("/")+1);c.loadPathOf("flair.app",Xe);let Ye=JSON.parse('{"host":"flair.app.ServerHost | flair.app.ClientHost","app":"flair.app.App","boot":{"files":[],"preambles":[],"bootwares":[]},"di":{"container":{}}}'),Ze=e.Port("settingsReader");if("function"==typeof Ze){let e=Ze("flair.app");e&&(Ye=de([Ye,e],!1))}Ye=Object.freeze(Ye);let et=JSON.parse("{}");et=Object.freeze(et);let tt=()=>{};return c.context.current().currentAssemblyBeingLoaded("./flair.app{.min}.js"),await(async()=>{l("abstract"),l("ns","flair.app"),a("Bootware",function(){l("virtual"),this.construct=((e,t,a)=>{let i=U("name: string, version: string","name: string, version: string, isMountSpecific: boolean","name: string, isMountSpecific: boolean","name: string")(e,t,a);i.throwOnError(this.construct),this.info=Object.freeze({name:i.values.name||"",version:i.values.version||"",isMountSpecific:i.values.isMountSpecific||!1})}),l("virtual"),l("async"),this.boot=q,l("readonly"),this.info=null,l("virtual"),l("async"),this.ready=q,l("virtual"),this.dispose=q})})(),await(async()=>{const{IDisposable:e}=R();l("ns","flair.app"),a("Handler",[e],function(){l("virtual"),this.construct=(()=>{}),l("virtual"),this.dispose=(()=>{})})})(),await(async()=>{const{IDisposable:e}=R(),{Bootware:t}=R("flair.app");l("ns","flair.app"),a("App",t,[e],function(){l("override"),this.construct=(e=>{let t=H(this);e(t.title,t.version)}),l("override"),l("sealed"),this.boot=(async e=>{e(),c.host().error.add(this.handleError)}),this.start=(async()=>{if(!ee.isServer&&!ee.isWorker){const{ViewState:e}=R("flair.ui");new e}await this.onStart()}),l("virtual"),l("async"),this.onStart=q,l("override"),l("sealed"),this.ready=(async()=>{await this.onReady()}),l("virtual"),l("async"),this.onReady=q,this.stop=(async()=>{if(!ee.isServer&&!ee.isWorker){const{ViewState:e}=R("flair.ui");(new e).clear()}await this.onStop()}),l("virtual"),l("async"),this.onStop=q,l("private"),this.handleError=(e=>{this.onError(e.args.error)}),l("virtual"),this.onError=(e=>{throw G.OperationFailed(e,this.onError)}),l("override"),this.dispose=(e=>{e(),c.host().error.remove(this.handleError)})})})(),await(async()=>{const{IDisposable:e}=R(),{Bootware:t}=R("flair.app");l("ns","flair.app"),a("Host",t,[e],function(){l("virtual"),l("async"),this.start=q,l("virtual"),l("async"),this.stop=q,this.error=Y(e=>({error:e})),this.raiseError=(e=>{this.error(e)})})})(),await(async()=>{const{Attribute:e}=R();l("ns","(root)"),a("cache",e,function(){l("override"),this.construct=((e,t)=>{e(t),this.cacheConfig="number"==typeof t?{duration:t}:t,this.enabled=this.cacheConfig&&this.cacheConfig.duration,this.cacheHandler=h("cacheHandler"),this.constraints="(class || struct) && (func && async) && !(timer || on || @fetch || @cache)"}),l("readonly"),this.cacheConfig=null,l("private"),this.cacheHandler=null,l("private"),this.enabled=!1,l("override"),this.decorateFunction=((e,t,a,i)=>{let r=this,s=`${t}___${a}`,o=async(...e)=>{let t=await i(...e);return r.enabled&&await r.cacheHandler.set(s,r.cacheConfig,t),t};return async function(...e){if(r.enabled)try{return await r.cacheHandler.get(s,r.cacheConfig)}catch(e){}return await o(...e)}})})})(),await(async()=>{const{Bootware:t}=R("flair.app");l("static"),l("ns","flair.app"),a("BootEngine",function(){this.start=async function(){let a=[],i=[];const r=async()=>{for(let e of Ye.boot.files)(e=ce(e))&&await u(e)},s=async()=>{if(ee.isClient&&!ee.isWorker)for(let e of Ye.boot.links){let t=document.createElement("link");for(let a in e)t[a]=e[a];(!0).document.getElementsByTagName("head")[0].appendChild(t)}},o=async()=>{let t=null;for(let a of Ye.boot.preambles)(a=ce(a))&&(a.endsWith("/")||(a+="/"),a+="preamble.js",t=await u(a),await t(e))},n=async()=>{let e=null,r=null,s=null;for(let o of Ye.boot.bootwares)(o=ce(o))&&(e=await u(o))&&"boolean"!=typeof e&&(r=g(e,t))&&(s=new r,a.push(s),s.info.isMountSpecific&&i.push(s))},l=async e=>{if(ee.isWorker){0!==i.length&&console.warn("Mount specific bootwares are not supported for worker environment. Revisit worker:flair.app->load setting.");for(let t of a)t.info.isMountSpecific||await t[e]()}else{let t=c.host().mounts,r=Object.keys(t),s="",o=null;o=t[s="main"];for(let t of a)await t[e](o);for(let a of r)if("main"!==a){o=t[a];for(let t of i)await t[e](o)}}},p=async()=>{const e=await u(Ye.host),t=await u(Ye.app);if(!ee.isWorker){let t=new e;await t.boot(),c.host(t)}await l("boot");let a=new t;await a.boot(),c.app(a)},f=async()=>{ee.isWorker||await c.host().start(),await c.app().start()},d=()=>new Promise((e,t)=>{"loading"!==document.readyState?e():(!0).document.addEventListener("DOMContentLoaded",()=>{e()})}),h=()=>new Promise((e,t)=>{(!0).document.addEventListener("deviceready",()=>{e()},!1)}),y=async()=>{ee.isClient&&!ee.isWorker&&(await d(),ee.isCordova&&await h()),ee.isWorker||await c.host().ready(),await l("ready"),await c.app().ready()};return await s(),await r(),await o(),await n(),await p(),await f(),await y(),console.log("ready!"),!0}})})(),await(async()=>{const{Bootware:e}=R("flair.app");l("sealed"),l("ns","flair.boot"),a("DIContainer",e,function(){l("override"),this.construct=(e=>{e("DI Container")}),l("override"),this.boot=(async e=>{e();let t=Ye.di.container;for(let e in t)t.hasOwnProperty(e)&&d.register(e,t[e])})})})(),c.context.current().currentAssemblyBeingLoaded(""),c.registerAdo('{"name":"flair.app","file":"./flair.app{.min}.js","package":"flairjs-fabric","desc":"Foundation for True Object Oriented JavaScript Apps","title":"Flair.js Fabric","version":"0.55.24","lupdate":"Fri, 09 Aug 2019 19:18:02 GMT","builder":{"name":"flairBuild","version":"1","format":"fasm","formatVersion":"1","contains":["init","func","type","vars","reso","asst","rout","sreg"]},"copyright":"(c) 2017-2019 Vikas Burman","license":"MIT","types":["flair.app.Bootware","flair.app.Handler","flair.app.App","flair.app.Host","cache","flair.app.BootEngine","flair.boot.DIContainer"],"resources":[],"assets":[],"routes":[]}'),Object.freeze({name:"flair.app",settings:Ye,config:et})});
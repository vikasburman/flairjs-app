/**
 * @preserve
 * Flair.js Fabric
 * Foundation for True Object Oriented JavaScript Apps
 * 
 * Assembly: flair.app
 *     File: ./flair.app.js
 *  Version: 0.59.69
 *  Sun, 22 Sep 2019 13:53:35 GMT
 * 
 * (c) 2017-2019 Vikas Burman
 * MIT
 */
!function(e,t){"use strict";"function"==typeof!0&&(!0).amd?(!0)(()=>t):"object"==typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),module.exports=exports=t):e["flair.app"]=t}(this,async function(e,t){"use strict";const{Class:a,Struct:i,Enum:r,Interface:s,Mixin:o,Aspects:n,AppDomain:l,$$:c,attr:f,bring:p,Container:u,include:d,Port:h,on:w,post:y,telemetry:m,Reflector:b,Serializer:g,Tasks:v,as:S,is:C,isDefined:x,isComplies:E,isDerivedFrom:k,isAbstract:A,isSealed:O,isStatic:j,isSingleton:B,isDeprecated:I,isImplements:M,isInstanceOf:T,isMixed:H,getAssembly:D,getAttr:W,getContext:F,getResource:P,getRoute:R,getType:L,ns:N,getTypeOf:V,getTypeName:z,typeOf:$,dispose:J,using:_,Args:U,Exception:G,noop:q,nip:K,nim:Q,nie:X,event:Y}=e,{TaskInfo:Z}=e.Tasks,{env:ee}=e.options,{guid:te,stuff:ae,replaceAll:ie,splitAndTrim:re,findIndexByProp:se,findItemByProp:oe,which:ne,isArrowFunc:le,isASyncFunc:ce,sieve:fe,deepMerge:pe,getLoadedScript:ue,b64EncodeUnicode:de,b64DecodeUnicode:he,lens:we,globalSetting:ye}=e.utils,me=ee.isServer||ee.isWorker?null:(!0).document,be=l.context.current().name,ge=t,ve=ge.substr(0,ge.lastIndexOf("/")+1);l.loadPathOf("flair.app",ve);let Se=JSON.parse('{"host":"flair.app.ServerHost | flair.app.ClientHost","app":"flair.app.App","boot":{"env":{"isVue":false,"isExpress":false,"isServerless":false,"isFirebase":false},"links":[],"scripts":[],"meta":[],"preambles":[],"ports":{},"bootwares":[],"coreAssemblies":["./flair.app.js","isServer: ./flair.server.js","isClient: ./flair.client.js","isVue: ./flair.client.vue.js","isExpress: ./flair.server.express.js","isFirebase: ./flair.server.firebase.js"],"assemblies":[]},"di":{"container":{}}}'),Ce=h("settingsReader");if("function"==typeof Ce){let e=Ce("flair.app");e&&(Se=pe([Se,e],!1))}Se=Object.freeze(Se);let xe=JSON.parse("{}");xe=Object.freeze(xe);const Ee=e=>{const t=(t,a)=>{let i=e.getType(a);i&&u.register(t,i)};t("cache","flair.app.attr.Cache")};return l.context.current().currentAssemblyBeingLoaded("./flair.app{.min}.js"),await(async()=>{c("abstract"),c("ns","flair.app"),a("Bootware",function(){c("virtual"),this.construct=((e,t,a)=>{let i=U("name: string, version: string","name: string, version: string, isMountSpecific: boolean","name: string, isMountSpecific: boolean","name: string")(e,t,a);i.throwOnError(this.construct),this.info=Object.freeze({name:i.values.name||"",version:i.values.version||"",isMountSpecific:i.values.isMountSpecific||!1})}),c("virtual"),c("async"),this.boot=q,c("readonly"),this.info=null,c("virtual"),c("async"),this.ready=q,c("virtual"),this.dispose=q,c("protected"),this.getMountSpecificSettings=((e,t,a,i)=>{let r=[];if(t.all&&t.all.before&&t.all.before[e]&&r.push(...t.all.before[e]),t[a]&&t[a][e])if(0===r.length)r.push(...t[a][e]);else if(i)for(let s of t[a][e]){let e=oe(r,i,s[i]);if(null!==e)for(let t in s)e[t]=s[t];else r.push(s)}else for(let i of t[a][e])"string"==typeof i&&-1!==r.indexOf(i)||r.push(i);if(t.all&&t.all.after&&t.all.after[e])if(0===r.length)r.push(...t.all.after[e]);else if(i)for(let a of t.all.after[e]){let e;null!==oe(r,i,a[i])||r.push(a)}else for(let a of t.all.after[e])"string"==typeof a&&-1!==r.indexOf(a)||r.push(a);return r})})})(),await(async()=>{const{IDisposable:e}=await N();c("ns","flair.app"),a("Handler",[e],function(){c("virtual"),this.construct=(e=>{this.route=l.context.current().getRoute(e.name)}),c("protected"),this.route=null,c("virtual"),this.dispose=q})})(),await(async()=>{const{IDisposable:e}=await N(),{Bootware:t}=await N("flair.app");c("ns","flair.app"),a("App",t,[e],function(){c("override"),this.construct=(e=>{let t=D(this);e(t.title,t.version)}),c("override"),c("sealed"),this.boot=(async e=>{e(),l.host().error.add(this.handleError)}),this.start=(async()=>{if(!ee.isServer&&!ee.isWorker){const{ViewState:e}=await N("flair.ui");new e}await this.onStart()}),c("virtual"),c("async"),this.onStart=q,c("override"),c("sealed"),this.ready=(async()=>{await this.onReady()}),c("virtual"),c("async"),this.onReady=q,this.stop=(async()=>{if(!ee.isServer&&!ee.isWorker){const{ViewState:e}=await N("flair.ui");(new e).clear()}await this.onStop()}),c("virtual"),c("async"),this.onStop=q,c("private"),this.handleError=(e=>{this.onError(e.args.error)}),c("virtual"),this.onError=(e=>{throw G.OperationFailed(e,this.onError)}),c("virtual"),c("async"),this.getRoutingContext=q,c("override"),this.dispose=(e=>{e(),l.host().error.remove(this.handleError)})})})(),await(async()=>{const{IDisposable:e}=await N(),{Bootware:t}=await N("flair.app");c("ns","flair.app"),a("Host",t,[e],function(){c("virtual"),c("async"),this.start=q,c("virtual"),c("async"),this.stop=q,this.error=Y(e=>({error:e})),this.raiseError=(e=>{this.error(e)})})})(),await(async()=>{const{Bootware:t}=await N("flair.app");c("static"),c("ns","flair.app"),a("BootEngine",function(){this.start=async function(){let a=[],i=[];const r=async()=>{ee.x(Se.boot.env)},s=async()=>{if(ee.isClient&&!ee.isWorker){let e=(!0).document.getElementsByTagName("head")[0];for(let t of Se.boot.scripts){let a=document.createElement("script");for(let e in t)a[e]="src"===e?ne(t[e]):t[e];e.appendChild(a)}}},o=async()=>{if(ee.isClient&&!ee.isWorker){let e=(!0).document.getElementsByTagName("head")[0];for(let t of Se.boot.links){let a=document.createElement("link");for(let e in t)a[e]="href"===e?ne(t[e]):t[e];e.appendChild(a)}}},n=async()=>{if(ee.isClient&&!ee.isWorker){let e=(!0).document.getElementsByTagName("head")[0];for(let t of Se.boot.meta){let a=document.createElement("meta");for(let e in t)a[e]=t[e];e.appendChild(a)}}},c=async()=>{let t=null;for(let a of Se.boot.preambles)(a=ne(a))&&(a.endsWith("/")||(a+="/"),a+="preamble{.min}.js",t=await d(a),await t(e))},f=async()=>{const e=async e=>{if(-1!==(e=ne(e)).indexOf(":")){let t=e.split(":"),a=t[0].trim();e=t[1].trim(),(ee[a]||ee.x()[a])&&await l.context.loadAssembly(e)}else await l.context.loadAssembly(e)};for(let t of Se.boot.coreAssemblies)await e(t);for(let t of Se.boot.assemblies)await e(t)},p=async()=>{let e=null,t="";for(let a in Se.boot.ports)(t=ne(Se.boot.ports[a]))&&(e=new(await d(t)),h.connect(a,e.factory))},u=async()=>{let e=null,r=null,s=null;for(let o of Se.boot.bootwares)(o=ne(o))&&(e=await d(o))&&"boolean"!=typeof e&&(r=S(e,t))&&(s=new r,a.push(s),s.info.isMountSpecific&&i.push(s))},w=async e=>{if(ee.isWorker){0!==i.length&&console.warn("Mount specific bootwares are not supported for worker environment. Revisit worker:flair.app->load setting.");for(let t of a)t.info.isMountSpecific||await t[e]()}else{let t=l.host().mounts,r=Object.keys(t),s="",o=null;o=t[s="main"];for(let t of a)await t[e](o);for(let a of r)if("main"!==a){o=t[a];for(let t of i)await t[e](o)}}},y=async()=>{const e=await d(Se.host),t=await d(Se.app);if(!ee.isWorker){let t=new e;await t.boot(),l.host(t)}await w("boot");let a=new t;await a.boot(),l.app(a)},m=async()=>{ee.isWorker||await l.host().start(),await l.app().start()},b=()=>new Promise((e,t)=>{"loading"!==document.readyState?e():(!0).document.addEventListener("DOMContentLoaded",()=>{e()})}),g=()=>new Promise((e,t)=>{(!0).document.addEventListener("deviceready",()=>{e()},!1)}),v=async()=>{ee.isClient&&!ee.isWorker&&(await b(),ee.isCordova&&await g()),ee.isWorker||await l.host().ready(),await w("ready"),await l.app().ready()};return await r(),await n(),await o(),await s(),await c(),await f(),await p(),await u(),await y(),await m(),await v(),console.log("ready!"),!0}})})(),await(async()=>{c("ns","flair.app"),s("IPortHandler",function(){this.port=K,this.factory=Q})})(),await(async()=>{const{Attribute:e}=N();c("ns","flair.app.attr"),a("Cache",e,function(){c("override"),this.construct=((e,t)=>{e(t),this.cacheConfig="number"==typeof t?{duration:t}:t,this.enabled=this.cacheConfig&&this.cacheConfig.duration,this.cacheHandler=h("cacheHandler"),this.constraints="(class || struct) && (func && async) && !(timer || on || @fetch || @cache)"}),c("readonly"),this.cacheConfig=null,c("private"),this.cacheHandler=null,c("private"),this.enabled=!1,c("override"),this.decorateFunction=((e,t,a,i)=>{let r=this,s=`${t}___${a}`,o=async(...e)=>{let t=await i(...e);return r.enabled&&await r.cacheHandler.set(s,r.cacheConfig,t),t};return async function(...e){if(r.enabled)try{return await r.cacheHandler.get(s,r.cacheConfig)}catch(e){}return await o(...e)}})})})(),await(async()=>{const{Bootware:e}=await N("flair.app");c("sealed"),c("ns","flair.boot"),a("DIContainer",e,function(){c("override"),this.construct=(e=>{e("DI Container")}),c("override"),this.boot=(async e=>{e();let t=Se.di.container;for(let e in t)t.hasOwnProperty(e)&&u.register(e,t[e])})})})(),l.context.current().currentAssemblyBeingLoaded("","function"==typeof Ee?Ee:null),l.registerAdo('{"name":"flair.app","file":"./flair.app{.min}.js","package":"flairjs-fabric","desc":"Foundation for True Object Oriented JavaScript Apps","title":"Flair.js Fabric","version":"0.59.69","lupdate":"Sun, 22 Sep 2019 13:53:35 GMT","builder":{"name":"flairBuild","version":"1","format":"fasm","formatVersion":"1","contains":["init","func","type","vars","reso","asst","rout","sreg"]},"copyright":"(c) 2017-2019 Vikas Burman","license":"MIT","types":["flair.app.Bootware","flair.app.Handler","flair.app.App","flair.app.Host","flair.app.BootEngine","flair.app.IPortHandler","flair.app.attr.Cache","flair.boot.DIContainer"],"resources":[],"assets":[],"routes":[]}'),Object.freeze({name:"flair.app",settings:Se,config:xe})});